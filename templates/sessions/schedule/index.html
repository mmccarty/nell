{% load custom %}

<h1>Schedule</h1>

<form action="{{ schedule }}" method="post">
    <input type="submit" value="Schedule Now!" >
    <!--
    start at <input type="text" name="start" \>
    for <input type="text" name="duration" \> hours<br \>
    -->
</form>

{% if periods %}
    <ul>
    {% for period in periods %}
        <li>{{ period.session.name }}
            ({{ period.session.observing_type }})
            at {{ period.start|dt2sex }} UTC
            for {{ period.duration|hrs2sex }}
            {% ifnotequal period.session.observing_type.type "maintenance" %}
                at {{ period.session.frequency }} GHz
            {% endifnotequal %}
            {% if period.backup %}
                (backup)
            {% endif %}
        </li>
    {% endfor %}
    </ul>
{% else %}
    <p>No periods scheduled.</p>
{% endif %}

<a href="/period/form">
  New Period
</a> <p>

<table border="1">
  {% for period in pfs %}
    {% ifchanged %}
      <tr bgcolor=orange>
        <th colspan="7">{{ period.date }}</th>
      </tr>
      <tr bgcolor=orange>
        <th>Time</th>
        <th>Name</th>
        <th>Type</th>
        <th>Freq (GHz)</th>
        <th>Score</th>
        <th>Notes</th>
      </tr>
    {% endifchanged %}
    <tr>
      <td>{{ period.start }}</td>
      {{ period.cntrl|safe }}
      <td rowspan="{{ period.dur }}">{{ period.stype }}</td>
      <td rowspan="{{ period.dur }}">{{ period.freq|safe }}</td>
      <td rowspan="{{ period.dur }}">{{ period.score|safe }}</td>
      <td rowspan="{{ period.dur }}">{{ period.notes|safe }}</td>
    </tr>
    {% for quarter in period.durs %}
      <tr>
        <td>{{ quarter }}</td>
      </tr>
    {% endfor %}
  {% endfor %}
</table>
